<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book Search</title>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 30px;
            background: #f4f4f4;
        }
        .container {
            max-width: 700px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
        }
        input {
            width: 100%;
            padding: 12px;
            border-radius: 6px;
            border: 1px solid #ccc;
            margin-bottom: 15px;
        }
        .book {
            background: #fafafa;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
        }
        img {
            max-width: 120px;
            margin-right: 15px;
        }
        .flex {
            display: flex;
        }
        a {
            color: #0070f3;
        }
    </style>
</head>
<body>

<div class="container">
    <h2>ðŸ“š Book Scraper Search</h2>

    <input id="search" placeholder="Cari buku (contoh: harry potter)..." />

    <div id="result"></div>
</div>

<script>
    const input = document.getElementById("search");
    const result = document.getElementById("result");

    input.addEventListener("keyup", async () => {
        const q = input.value.trim();

        if (!q) {
            result.innerHTML = "";
            return;
        }

        result.innerHTML = "Loading...";

        const res = await fetch(`/api/books?q=` + encodeURIComponent(q));
        const data = await res.json();

        if (!data.books.length) {
            result.innerHTML = "<p>Tidak ada hasil ðŸ˜”</p>";
            return;
        }

        result.innerHTML = data.books.map(book => `
            <div class="book">
                <div class="flex">
                    <img src="${book.thumbnail || ''}" />
                    <div>
                        <h3>${book.title || 'Tanpa Judul'}</h3>
                        <p><b>Author:</b> ${book.authors?.join(", ") || '-'}</p>
                        <p><b>Publisher:</b> ${book.publisher || '-'}</p>
                        <p><b>Date:</b> ${book.publishedDate || '-'}</p>
                        <p>${book.description?.substring(0, 150) || ''}...</p>

                        <p>
                            <b>Download:</b><br>
                            PDF: ${book.download_links?.pdf
                                ? `<a href="${book.download_links.pdf}" target="_blank">Download PDF</a>`
                                : 'Tidak tersedia'}<br>
                            EPUB: ${book.download_links?.epub
                                ? `<a href="${book.download_links.epub}" target="_blank">Download EPUB</a>`
                                : 'Tidak tersedia'}
                        </p>
                    </div>
                </div>
            </div>
        `).join("");
    });
</script>

</body>
      </html>
